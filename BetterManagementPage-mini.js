!function(){"use strict";if("id.sonyentertainmentnetwork.com"==window.location.host){if(window.location.toString().includes("/signin")){var e=window.location.toString();if(!e.includes("user%3Aaccount.profile.get%20user%3Aaccount.profile.update")){for(var t=e.split("&"),i=0;i<t.length;i++)t[i].startsWith("scope")&&(t[i]+="%20user%3Aaccount.profile.get%20user%3Aaccount.profile.update");window.location=t.join("&")}}else window.realNameClick=function(){var e=document.getElementsByClassName("primary-button row-button text-button")[0];window.overrideNameChangeRequest=!0;var t=document.getElementsByClassName("textfield ember-text-field ember-view")[0],i=document.getElementsByClassName("textfield ember-text-field ember-view")[1],n=document.getElementsByClassName("textfield ember-text-field ember-view")[2];window.overrideFirstName=t.value,window.overrideMiddleName=i.value,window.overrideLastName=n.value,t.value="OFirst",i.value="OMiddle",n.value="OLast";var o=document.createEvent("KeyboardEvent");o.initEvent("keyup",!0,!0),t.dispatchEvent(o),(o=document.createEvent("KeyboardEvent")).initEvent("keyup",!0,!0),i.dispatchEvent(o),(o=document.createEvent("KeyboardEvent")).initEvent("keyup",!0,!0),n.dispatchEvent(o),e.click()},window.updateAboutMe=function(e){var t=document.getElementsByClassName("textarea fixed-width ")[0];window.overrideAboutMe=t.value,t.value=e;e=document.createEvent("Event");e.initEvent("input",!0,!0),t.dispatchEvent(e)},window.waitForSave=function(){var e=document.getElementsByClassName("primary-button row-button text-button")[0];e.hasAttribute("disabled")?window.setTimeout(window.waitForSave,0):e.click()},window.aboutMeClick=function(){document.getElementsByClassName("primary-button row-button text-button")[0];window.overrideAboutMeChangeRequest=!0,window.updateAboutMe("OVERRIDDEN"),window.waitForSave()},window.updateRealNameLabel=function(){var e=document.getElementsByClassName("pdr-list-column main-text bold-text")[1];null!=e&&e.innerText.includes("OLast")?(e.innerText=e.innerText.replace("OFirst",window.overrideFirstName),e.innerText=e.innerText.replace("OMiddle",window.overrideMiddleName),e.innerText=e.innerText.replace("OLast",window.overrideLastName),(e=document.getElementsByClassName("profile-text-title max-two-lines")[0]).innerText=e.innerText.replace("OFirst",window.overrideFirstName),e.innerText=e.innerText.replace("OMiddle",window.overrideMiddleName),e.innerText=e.innerText.replace("OLast",window.overrideLastName)):window.setTimeout(window.updateRealNameLabel,0)},window.updateAboutMeLabel=function(){var e=document.getElementsByClassName("pdr-list-column main-text bold-text")[2];null!=e?e.innerText=window.originalAbout:window.setTimeout(window.updateAboutMeLabel,0)},window.cancelColorChange=function(){document.getElementById("colorChangeWindow").remove()},window.setColor=function(){window.selectedColor=document.getElementById("colorSelector").value.substring(1);var e=new XMLHttpRequest;e.open("PATCH","https://profile.api.playstation.com/v1/users/me/profile/backgroundImage",!0),e.setRequestHeaderOg("Content-Type","application/json"),e.setRequestHeaderOg("Authorization",window.loginToken),e.onreadystatechange=function(){4===this.readyState&&(document.getElementById("mainPageColor").innerText="#"+window.selectedColor,document.getElementById("mainPageColor").style.color=document.getElementById("mainPageColor").innerText,window.cancelColorChange())},e.send('{"ops":[{"op":"replace","path":"/color","value":"'+window.selectedColor+'"}]}')},window.newColorSelected=function(){document.getElementById("colorHex").innerText=document.getElementById("colorSelector").value},window.editColor=function(){var e=o('<div id="colorChangeWindow" data-components="pdr-popup" id="girlsdyingcute" class="ember-view"><div data-components="pdr-popup-frame" id="girlsdyingcutely" class="modal rows scroller theme-dimmer ember-view"> <div class="separator-pagetop dialog row-unshrink"></div><div class="row-flex"></div><div class="columns row-unshrink"> <div class="separator-frame beside column-unshrink"></div><div class="column-flex"></div><div class="popup-frame fixed-height rows theme-basebackground"> <div data-components="pdr-popup-header" id="girlsdyingiscute" class="separator-horizontal-hairline bottom ember-view"><div class="popup-header"> <div class="popup-header-text" dir="ltr">Profile Color</div><button onclick="window.cancelColorChange()" tabindex="0" title="Close" class="popup-header-icon close icon-header-close-black" dir="ltr" data-ember-action="" data-ember-action-220="220"></button></div></div><div data-components="kekka-scroller" id="girlsdyingiscute" class="outline-top scroller custom-scrollbar row-flex rows scroller-visible ember-view"><main tabindex="-1" data-components="pdr-main-content" id="girlsdyingiscute" class="rows flex-content theme-basebackground ember-view"> <div class="theme-noticeback row-unshrink"> <div data-components="pdr-notice" id="girlsdyingiscute" style="display: none;" class="row-notice item-notice ember-view"><div class="wrap-notice "> <div class="cell-notice top"> <div class="notice-icon-base " title=""></div></div><div class="cell-notice middle"> <div class="separator-notice text-notice text-margin " dir="ltr"></div></div></div></div></div><div class="separator-pagetop middle row-unshrink"></div><div class="columns row-flex"> <div class="popup-content-wrapper rows"> <div class="label description-regular" dir="ltr">You can change the color of your PSN Profile Page to anything you want.</div><div class="separator-pageitems row-unshrink"></div><div data-components="pdr-color-change" id="girlsdyingiscute" class="ember-view"><div class="grid-parent description-input-title"> <div class="grid-child description-input-title" dir="ltr">Update your profile color: </div><div> <input id="colorSelector" onchange="window.newColorSelected()" type="color"> <span id="colorHex">#000000</span></div></div></div><div class="separator-pageitems small"></div><div class="separator-pageitems"></div><div class="columns-center"> <div data-components="pdr-button" id="girlsdyingiscute" class="column-flex button ember-view"><button onclick="window.cancelColorChange()" tabindex="0" class="secondary-button row-button text-button" type="button"><span dir="ltr" class="caption">Cancel</span></button></div><div class="separator-pageitems beside narrow"></div><div data-components="pdr-button" id="girlsdyingiscute" class="column-flex button ember-view"><button onclick="window.setColor()" tabindex="0" class="primary-button row-button text-button"><span dir="ltr" class="caption">Set Color</span></button></div></div></div></div><div class="separator-pagefooter middle row-unshrink"></div></main></div></div><div class="column-flex"></div><div class="separator-frame beside column-unshrink"></div></div><div class="row-flex"></div><div class="separator-pagefooter dialog row-unshrink"></div></div></div>');document.getElementById("modalarea").appendChild(e),document.getElementById("colorSelector").value="#"+window.selectedColor,document.getElementById("colorHex").innerText="#"+window.selectedColor},window.buttonAdded=!1,window.colorAdded=!1,window.enablePage=function(){window.setTimeout(window.enablePage,5);var e,t=document.getElementsByClassName("primary-button row-button text-button")[0];null!=t?(n=document.querySelector("*[data-components='pdr-about-me']"),null==(e=document.getElementsByClassName("theme-realname ember-view")[0])&&null==n||window.buttonAdded||(window.buttonAdded=!0,(i=t.parentElement.parentElement).appendChild(document.createElement("div")).setAttribute("class","separator-pageitems beside narrow"),(i=i.appendChild(document.createElement("div"))).setAttribute("data-components","pdr-button"),i.setAttribute("class","column-flex button ember-view"),(i=i.appendChild(document.createElement("button"))).innerHTML='<span dir="ltr" class="caption">Force Save</span>',i.setAttribute("tabIndex",3),i.setAttribute("class","primary-button row-button text-button"),null!=e&&i.setAttribute("onclick","realNameClick()"),null!=n&&(updateAboutMe(document.getElementsByClassName("pdr-list-column main-text bold-text")[2].innerText),i.setAttribute("onclick","aboutMeClick()")))):window.buttonAdded=!1;var i,n=window.location.toString().includes("/psn_profile");n&&0==window.colorAdded?0!=document.getElementsByClassName("pdr-list-item ember-view").length&&((i=new XMLHttpRequest).open("GET","https://profile.api.playstation.com/v1/users/me/profile?fields=backgroundImage",!0),i.setRequestHeaderOg("Content-Type","application/json; charset=UTF-8-Type"),i.setRequestHeaderOg("Authorization",window.loginToken),i.onreadystatechange=function(){var e,t;4===this.readyState&&(window.selectedColor=JSON.parse(this.responseText).backgroundImage.color,e=document.getElementsByClassName("row-unshrink")[11].children[0],t=o('<li data-components="pdr-li" id="girlsdyingcute" class="ember-view"><div data-components="pdr-li-row" id="girlsdyingcutely" class="pdr-list-item ember-view"> <div class="pdr-list-column flex-width fixed-width has-hint"> <div class="pdr-list-item"> <div class="pdr-list-column flex-width "> <div class="pdr-list-item inner-list-item " style=""> <div class="pdr-list-column flex-width column-unshrink "> <div class="pdr-list-item"> <div class="pdr-list-column main-text fitting-width "> <div id="girlsdyingiscute" data-components="pdr-label" class="label ember-view"><div> <div class="grid-parent "> <div class="grid-child "> <span dir="ltr" class="label-title" id="profile_color">Profile Color</span> </div></div></div></div></div></div></div></div></div></div></div><div class="pdr-list-column flex-width "> <div class="pdr-list-item"> <div class="pdr-list-column flex-width "> <div class="pdr-list-item inner-list-item " style=""> <div class="pdr-list-column flex-width column-unshrink "> <div class="pdr-list-item"> <div class="pdr-list-column main-text bold-text" dir="ltr" id="mainPageColor">#'+window.selectedColor.toString()+'</div></div></div></div></div><div class="pdr-list-column column-unshrink button-column "> <div data-components="pdr-button" id="girlsdyingiscute" class="list-cam-narrow-button expand-taparea button ember-view"><button tabindex="0" class="secondary-button row-button text-button disabled-loading-caption" type="button" onclick="window.editColor()"><span dir="ltr" class="caption">Edit</span></button></div></div></div></div></div></li>'),e.appendChild(t),document.getElementById("mainPageColor").style.color=document.getElementById("mainPageColor").innerText)},i.send(),window.colorAdded=!0):n||(window.colorAdded=!1)},XMLHttpRequest.prototype.openOg=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(e,t,i){return"GET"==e&&t.includes("regcam/api")&&t.includes("users/me/profile")&&(this.sendOg=this.send,this.send=function(){return this.onreadystatechangeOg=this.onreadystatechange,this.onreadystatechange=function(){var e,t;return 4===this.readyState&&(e=this.response,t=this.responseText,window.originalAbout=JSON.parse(e).aboutMe,window.updateAboutMeLabel(),Object.defineProperty(this,"response",{writable:!0}),Object.defineProperty(this,"responseText",{writable:!0}),this.response=e.replace(/\\u..../g,""),this.responseText=t.replace(/\\u..../g,""),Object.defineProperty(this,"response",{writable:!1}),Object.defineProperty(this,"responseText",{writable:!1})),this.onreadystatechangeOg()},this.sendOg()}),"POST"==e&&t.includes("users/me/profile")&&window.overrideAboutMeChangeRequest&&(this.sendOg=this.send,this.send=function(e){var t=JSON.parse(e);t.aboutMe=window.overrideAboutMe;var i=JSON.stringify(t);console.log(e+" -> "+i),this.onreadystatechangeOg=this.onreadystatechange,this.onreadystatechange=function(){return 4===this.readyState&&500==this.status&&(Object.defineProperty(this,"status",{writable:!0}),Object.defineProperty(this,"statusText",{writable:!0}),this.status=200,this.statusText="OK",Object.defineProperty(this,"status",{writable:!1}),Object.defineProperty(this,"statusText",{writable:!1})),this.onreadystatechangeOg()},window.overrideAboutMeChangeRequest=!1;try{return this.sendOg(i)}catch(e){}}),"PUT"==e&&t.includes("/realName")&&window.overrideNameChangeRequest&&(this.sendOg=this.send,this.send=function(e){var t=JSON.parse(e);t.first=window.overrideFirstName,t.middle=window.overrideMiddleName,t.last=window.overrideLastName;t=JSON.stringify(t);return console.log(e+" -> "+t),window.updateRealNameLabel(),this.sendOg(t)},window.overrideNameChangeRequest=!1),"PUT"==e&&t.includes("users/me/avatar")&&(this.sendOg=this.send,this.send=function(e){'{"avatarId":100000}'==e&&(console.log("Setting default avatar."),e='{"avatarId":0}'),this.sendOg(e)}),"GET"==e&&t.includes("avatars/categories/0?offset=0&limit=48")&&(this.sendOg=this.send,this.send=function(){return this.onreadystatechangeOg=this.onreadystatechange,this.onreadystatechange=function(){var e;return 4===this.readyState&&((e=JSON.parse(this.response)).avatars.unshift({avatarId:1e5,avatarUrls:[{size:"m",avatarUrl:"https://static-resource.np.community.playstation.net/avatar_m/default/DefaultAvatar_m.png"}]}),e=JSON.stringify(e),Object.defineProperty(this,"response",{writable:!0}),Object.defineProperty(this,"responseText",{writable:!0}),this.response=e,this.responseText=e,Object.defineProperty(this,"response",{writable:!1}),Object.defineProperty(this,"responseText",{writable:!1})),this.onreadystatechangeOg()},this.sendOg()}),this.openOg(e,t,i)},XMLHttpRequest.prototype.setRequestHeaderOg=XMLHttpRequest.prototype.setRequestHeader,XMLHttpRequest.prototype.setRequestHeader=function(e,t){return"Authorization"==e&&(null==window.loginToken&&window.setTimeout(window.enablePage,0),window.loginToken=t,console.log("Found token: "+t)),this.setRequestHeaderOg(e,t)},alert("Better Management Page script by SilicaAndPina loaded! and on the correct domain.");function o(e){var t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}}else alert('Wrong domain! please run on\n"https://id.sonyentertainmentnetwork.com/id/management/#/p/psn_profile".')}();
